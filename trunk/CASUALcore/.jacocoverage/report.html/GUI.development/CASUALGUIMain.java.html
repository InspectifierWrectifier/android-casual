<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>CASUALGUIMain.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">JaCoCoverage analysis of project &quot;CASUALcore&quot; (powered by JaCoCo from EclEmma)</a> &gt; <a href="index.source.html" class="el_package">GUI.development</a> &gt; <span class="el_source">CASUALGUIMain.java</span></div><h1>CASUALGUIMain.java</h1><pre class="source lang-java linenums">/*CASUALJFrame provides UI for CASUAL. 
 *Copyright (C) 2015  Adam Outler
 *
 *  This program is free software: you can redistribute it and/or modify
 *  it under the terms of the GNU General Public License as published by
 *  the Free Software Foundation, either version 3 of the License, or
 *  (at your option) any later version.
 *
 *  This program is distributed in the hope that it will be useful,
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *  GNU General Public License for more details.
 *
 *  You should have received a copy of the GNU General Public License
 *  along with this program.  If not, see https://www.gnu.org/licenses/ .
 */
package GUI.development;

import CASUAL.AudioHandler;
import CASUAL.CASUALConnectionStatusMonitor;
import CASUAL.CASUALMain;
import CASUAL.CASUALMessageObject;
import CASUAL.CASUALScriptParser;
import CASUAL.CASUALSessionData;
import CASUAL.CASUALStartupTasks;
import CASUAL.FileOperations;
import CASUAL.Log;
import CASUAL.caspac.Caspac;
import CASUAL.caspac.Script;
import CASUAL.iCASUALUI;
import CASUAL.misc.CASUALScrFilter;
import CASUAL.network.LinkLauncher;
import java.awt.Component;
import java.awt.HeadlessException;
import java.awt.event.WindowAdapter;
import java.awt.event.WindowEvent;
import java.awt.image.BufferedImage;
import java.io.IOException;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.ImageIcon;
import javax.swing.JComboBox;
import javax.swing.JFileChooser;
import javax.swing.JOptionPane;
import static javax.swing.JOptionPane.ERROR_MESSAGE;
import static javax.swing.JOptionPane.YES_OPTION;
import javax.swing.border.Border;
import javax.swing.border.TitledBorder;
import javax.swing.text.BadLocationException;

/**
 * provides UI for CASUAL.
 *
 * @author Adam Outler adamoutler@gmail.com
 */
public final class CASUALGUIMain extends javax.swing.JFrame implements iCASUALUI {

    private static final long serialVersionUID = 1L;

<span class="fc" id="L60">    private boolean isReady = false;</span>
<span class="fc" id="L61">    final private boolean isDummyGUI = false;</span>
    Caspac caspac;
    String nonResourceFileName;

<span class="fc" id="L65">    FileOperations fileOperations = new FileOperations();</span>
<span class="fc" id="L66">    private String ComboBoxValue = &quot;&quot;;</span>

    /**
     * Creates new form CASUALJFrame2
     */
<span class="fc" id="L71">    public CASUALGUIMain() {</span>
<span class="fc" id="L72">        notificationCASUALSound();</span>
<span class="fc" id="L73">        initComponents();</span>
        //set up place to log to for GUI
        //ProgressArea.setContentType(&quot;text/html&quot;);
<span class="fc" id="L76">        ProgressArea.setAutoscrolls(true);</span>
<span class="fc" id="L77">        ProgressArea.setText(CASUALMain.getSession().PreProgress + ProgressArea.getText());</span>

<span class="fc" id="L79">        CASUALStartupTasks.lockGUIformPrep = false;</span>

<span class="fc" id="L81">        addWindowListener(new WindowAdapter() {</span>
            @Override
            public void windowClosing(WindowEvent we) {

<span class="nc" id="L85">                CASUAL.CASUALMain.shutdown(0);</span>
<span class="nc" id="L86">            }</span>
        });

<span class="fc" id="L89">    }</span>

    /*
     * Timer for adb devices
     */
    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings({&quot;rawtypes&quot;, &quot;unchecked&quot;}) //needed because JDK6 does not support type-modified JComboBoxes
    // &lt;editor-fold defaultstate=&quot;collapsed&quot; desc=&quot;Generated Code&quot;&gt;//GEN-BEGIN:initComponents
    private void initComponents() {

<span class="fc" id="L103">        FileChooser1 = new javax.swing.JFileChooser();</span>
<span class="fc" id="L104">        windowBanner = new javax.swing.JLabel();</span>
<span class="fc" id="L105">        comboBoxScriptSelector = new JComboBox&lt;String&gt;();</span>
<span class="fc" id="L106">        startButton = new javax.swing.JButton();</span>
<span class="fc" id="L107">        DonateButton = new javax.swing.JButton();</span>
<span class="fc" id="L108">        jPanel1 = new javax.swing.JPanel();</span>
<span class="fc" id="L109">        progressBar = new javax.swing.JProgressBar();</span>
<span class="fc" id="L110">        StatusLabel = new javax.swing.JLabel();</span>
<span class="fc" id="L111">        jSeparator1 = new javax.swing.JSeparator();</span>
<span class="fc" id="L112">        informationScrollPanel = new javax.swing.JScrollPane();</span>
<span class="fc" id="L113">        ProgressArea = new javax.swing.JTextPane();</span>
<span class="fc" id="L114">        jMenuBar1 = new javax.swing.JMenuBar();</span>
<span class="fc" id="L115">        jMenu1 = new javax.swing.JMenu();</span>
<span class="fc" id="L116">        MenuItemOpenScript = new javax.swing.JMenuItem();</span>
<span class="fc" id="L117">        MenuItemExit = new javax.swing.JMenuItem();</span>
<span class="fc" id="L118">        jMenu2 = new javax.swing.JMenu();</span>
<span class="fc" id="L119">        MenuItemShowDeveloperPane = new javax.swing.JMenuItem();</span>
<span class="fc" id="L120">        jMenuItem1 = new javax.swing.JMenuItem();</span>
<span class="fc" id="L121">        MenuItemShowAboutBox = new javax.swing.JMenuItem();</span>

<span class="fc" id="L123">        FileChooser1.setDialogTitle(&quot;Select a CASUAL \&quot;scr\&quot; file&quot;);</span>

<span class="fc" id="L125">        addWindowListener(new java.awt.event.WindowAdapter() {</span>
            public void windowClosing(java.awt.event.WindowEvent evt) {
<span class="nc" id="L127">                formWindowClosing(evt);</span>
<span class="nc" id="L128">            }</span>
        });

<span class="fc" id="L131">        windowBanner.setFont(new java.awt.Font(&quot;Ubuntu&quot;, 0, 36)); // NOI18N</span>
<span class="fc" id="L132">        windowBanner.setText(&quot;loading.. please wait&quot;);</span>

<span class="fc" id="L134">        comboBoxScriptSelector.setEnabled(false);</span>
<span class="fc" id="L135">        comboBoxScriptSelector.addPopupMenuListener(new javax.swing.event.PopupMenuListener() {</span>
            public void popupMenuCanceled(javax.swing.event.PopupMenuEvent evt) {
<span class="nc" id="L137">            }</span>
            public void popupMenuWillBecomeInvisible(javax.swing.event.PopupMenuEvent evt) {
<span class="nc" id="L139">                comboBoxScriptSelectorPopupMenuWillBecomeInvisible(evt);</span>
<span class="nc" id="L140">            }</span>
            public void popupMenuWillBecomeVisible(javax.swing.event.PopupMenuEvent evt) {
<span class="nc" id="L142">            }</span>
        });
<span class="fc" id="L144">        comboBoxScriptSelector.addActionListener(new java.awt.event.ActionListener() {</span>
            public void actionPerformed(java.awt.event.ActionEvent evt) {
<span class="fc" id="L146">                comboBoxScriptSelectorActionPerformed(evt);</span>
<span class="fc" id="L147">            }</span>
        });

<span class="fc" id="L150">        startButton.setText(&quot;Do It!&quot;);</span>
<span class="fc" id="L151">        startButton.setEnabled(false);</span>
<span class="fc" id="L152">        startButton.addMouseListener(new java.awt.event.MouseAdapter() {</span>
            public void mouseClicked(java.awt.event.MouseEvent evt) {
<span class="nc" id="L154">                startButtonMouseClicked(evt);</span>
<span class="nc" id="L155">            }</span>
            public void mouseExited(java.awt.event.MouseEvent evt) {
<span class="nc" id="L157">                startButtonMouseExited(evt);</span>
<span class="nc" id="L158">            }</span>
        });
<span class="fc" id="L160">        startButton.addActionListener(new java.awt.event.ActionListener() {</span>
            public void actionPerformed(java.awt.event.ActionEvent evt) {
<span class="nc" id="L162">                startButtonActionPerformed(evt);</span>
<span class="nc" id="L163">            }</span>
        });

<span class="fc" id="L166">        DonateButton.setText(&quot;Donate&quot;);</span>
<span class="fc" id="L167">        DonateButton.addActionListener(new java.awt.event.ActionListener() {</span>
            public void actionPerformed(java.awt.event.ActionEvent evt) {
<span class="nc" id="L169">                DonateButtonActionPerformed(evt);</span>
<span class="nc" id="L170">            }</span>
        });

<span class="fc" id="L173">        StatusLabel.setFont(new java.awt.Font(&quot;Ubuntu&quot;, 0, 20)); // NOI18N</span>
<span class="fc" id="L174">        StatusLabel.setIcon(new javax.swing.ImageIcon(getClass().getResource(&quot;/GUI/development/resources/images/DeviceDisconnected.png&quot;))); // NOI18N</span>
<span class="fc" id="L175">        StatusLabel.addMouseListener(new java.awt.event.MouseAdapter() {</span>
            public void mouseClicked(java.awt.event.MouseEvent evt) {
<span class="nc" id="L177">                StatusLabelMouseClicked(evt);</span>
<span class="nc" id="L178">            }</span>
            public void mouseExited(java.awt.event.MouseEvent evt) {
<span class="nc" id="L180">                StatusLabelMouseExited(evt);</span>
<span class="nc" id="L181">            }</span>
        });

<span class="fc" id="L184">        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);</span>
<span class="fc" id="L185">        jPanel1.setLayout(jPanel1Layout);</span>
<span class="fc" id="L186">        jPanel1Layout.setHorizontalGroup(</span>
<span class="fc" id="L187">            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)</span>
<span class="fc" id="L188">            .addGroup(jPanel1Layout.createSequentialGroup()</span>
<span class="fc" id="L189">                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)</span>
<span class="fc" id="L190">                    .addGroup(jPanel1Layout.createSequentialGroup()</span>
<span class="fc" id="L191">                        .addContainerGap()</span>
<span class="fc" id="L192">                        .addComponent(StatusLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 300, javax.swing.GroupLayout.PREFERRED_SIZE)</span>
<span class="fc" id="L193">                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)</span>
<span class="fc" id="L194">                        .addComponent(progressBar, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))</span>
<span class="fc" id="L195">                    .addComponent(jSeparator1))</span>
<span class="fc" id="L196">                .addContainerGap())</span>
        );
<span class="fc" id="L198">        jPanel1Layout.setVerticalGroup(</span>
<span class="fc" id="L199">            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)</span>
<span class="fc" id="L200">            .addGroup(jPanel1Layout.createSequentialGroup()</span>
<span class="fc" id="L201">                .addComponent(jSeparator1, javax.swing.GroupLayout.PREFERRED_SIZE, 6, javax.swing.GroupLayout.PREFERRED_SIZE)</span>
<span class="fc" id="L202">                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)</span>
<span class="fc" id="L203">                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)</span>
<span class="fc" id="L204">                    .addComponent(StatusLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 26, javax.swing.GroupLayout.PREFERRED_SIZE)</span>
<span class="fc" id="L205">                    .addComponent(progressBar, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))</span>
<span class="fc" id="L206">                .addContainerGap())</span>
        );

<span class="fc" id="L209">        informationScrollPanel.setBorder(javax.swing.BorderFactory.createTitledBorder(null, &quot;Important Information&quot;, javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font(&quot;Ubuntu&quot;, 1, 10))); // NOI18N</span>

<span class="fc" id="L211">        ProgressArea.setCursor(new java.awt.Cursor(java.awt.Cursor.TEXT_CURSOR));</span>
<span class="fc" id="L212">        informationScrollPanel.setViewportView(ProgressArea);</span>

<span class="fc" id="L214">        jMenu1.setText(&quot;File&quot;);</span>

<span class="fc" id="L216">        MenuItemOpenScript.setAccelerator(javax.swing.KeyStroke.getKeyStroke(java.awt.event.KeyEvent.VK_O, java.awt.event.InputEvent.SHIFT_MASK));</span>
<span class="fc" id="L217">        MenuItemOpenScript.setText(&quot;Open CASUAL script&quot;);</span>
<span class="fc" id="L218">        MenuItemOpenScript.addActionListener(new java.awt.event.ActionListener() {</span>
            public void actionPerformed(java.awt.event.ActionEvent evt) {
<span class="nc" id="L220">                MenuItemOpenScriptActionPerformed(evt);</span>
<span class="nc" id="L221">            }</span>
        });
<span class="fc" id="L223">        jMenu1.add(MenuItemOpenScript);</span>

<span class="fc" id="L225">        MenuItemExit.setAccelerator(javax.swing.KeyStroke.getKeyStroke(java.awt.event.KeyEvent.VK_E, java.awt.event.InputEvent.CTRL_MASK));</span>
<span class="fc" id="L226">        MenuItemExit.setText(&quot;Exit&quot;);</span>
<span class="fc" id="L227">        MenuItemExit.addActionListener(new java.awt.event.ActionListener() {</span>
            public void actionPerformed(java.awt.event.ActionEvent evt) {
<span class="nc" id="L229">                MenuItemExitActionPerformed(evt);</span>
<span class="nc" id="L230">            }</span>
        });
<span class="fc" id="L232">        jMenu1.add(MenuItemExit);</span>

<span class="fc" id="L234">        jMenuBar1.add(jMenu1);</span>

<span class="fc" id="L236">        jMenu2.setText(&quot;About&quot;);</span>

<span class="fc" id="L238">        MenuItemShowDeveloperPane.setAccelerator(javax.swing.KeyStroke.getKeyStroke(java.awt.event.KeyEvent.VK_D, java.awt.event.InputEvent.CTRL_MASK));</span>
<span class="fc" id="L239">        MenuItemShowDeveloperPane.setText(&quot;Developing A Script&quot;);</span>
<span class="fc" id="L240">        MenuItemShowDeveloperPane.addActionListener(new java.awt.event.ActionListener() {</span>
            public void actionPerformed(java.awt.event.ActionEvent evt) {
<span class="nc" id="L242">                MenuItemShowDeveloperPaneActionPerformed(evt);</span>
<span class="nc" id="L243">            }</span>
        });
<span class="fc" id="L245">        jMenu2.add(MenuItemShowDeveloperPane);</span>

<span class="fc" id="L247">        jMenuItem1.setAccelerator(javax.swing.KeyStroke.getKeyStroke(java.awt.event.KeyEvent.VK_L, java.awt.event.InputEvent.CTRL_MASK));</span>
<span class="fc" id="L248">        jMenuItem1.setText(&quot;Show Log&quot;);</span>
<span class="fc" id="L249">        jMenuItem1.addActionListener(new java.awt.event.ActionListener() {</span>
            public void actionPerformed(java.awt.event.ActionEvent evt) {
<span class="nc" id="L251">                jMenuItem1ActionPerformed(evt);</span>
<span class="nc" id="L252">            }</span>
        });
<span class="fc" id="L254">        jMenu2.add(jMenuItem1);</span>

<span class="fc" id="L256">        MenuItemShowAboutBox.setAccelerator(javax.swing.KeyStroke.getKeyStroke(java.awt.event.KeyEvent.VK_A, java.awt.event.InputEvent.CTRL_MASK));</span>
<span class="fc" id="L257">        MenuItemShowAboutBox.setText(&quot;About&quot;);</span>
<span class="fc" id="L258">        MenuItemShowAboutBox.addActionListener(new java.awt.event.ActionListener() {</span>
            public void actionPerformed(java.awt.event.ActionEvent evt) {
<span class="nc" id="L260">                MenuItemShowAboutBoxActionPerformed(evt);</span>
<span class="nc" id="L261">            }</span>
        });
<span class="fc" id="L263">        jMenu2.add(MenuItemShowAboutBox);</span>

<span class="fc" id="L265">        jMenuBar1.add(jMenu2);</span>

<span class="fc" id="L267">        setJMenuBar(jMenuBar1);</span>

<span class="fc" id="L269">        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());</span>
<span class="fc" id="L270">        getContentPane().setLayout(layout);</span>
<span class="fc" id="L271">        layout.setHorizontalGroup(</span>
<span class="fc" id="L272">            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)</span>
<span class="fc" id="L273">            .addGroup(layout.createSequentialGroup()</span>
<span class="fc" id="L274">                .addContainerGap()</span>
<span class="fc" id="L275">                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)</span>
<span class="fc" id="L276">                    .addComponent(jPanel1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)</span>
<span class="fc" id="L277">                    .addComponent(windowBanner, javax.swing.GroupLayout.DEFAULT_SIZE, 513, Short.MAX_VALUE)</span>
<span class="fc" id="L278">                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()</span>
<span class="fc" id="L279">                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)</span>
<span class="fc" id="L280">                            .addComponent(comboBoxScriptSelector, javax.swing.GroupLayout.Alignment.LEADING, 0, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)</span>
<span class="fc" id="L281">                            .addGroup(javax.swing.GroupLayout.Alignment.LEADING, layout.createSequentialGroup()</span>
<span class="fc" id="L282">                                .addComponent(startButton, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)</span>
<span class="fc" id="L283">                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)</span>
<span class="fc" id="L284">                                .addComponent(DonateButton))</span>
<span class="fc" id="L285">                            .addComponent(informationScrollPanel))</span>
<span class="fc" id="L286">                        .addContainerGap())))</span>
        );
<span class="fc" id="L288">        layout.setVerticalGroup(</span>
<span class="fc" id="L289">            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)</span>
<span class="fc" id="L290">            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()</span>
<span class="fc" id="L291">                .addComponent(windowBanner, javax.swing.GroupLayout.PREFERRED_SIZE, 61, javax.swing.GroupLayout.PREFERRED_SIZE)</span>
<span class="fc" id="L292">                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)</span>
<span class="fc" id="L293">                .addComponent(informationScrollPanel, javax.swing.GroupLayout.DEFAULT_SIZE, 432, Short.MAX_VALUE)</span>
<span class="fc" id="L294">                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)</span>
<span class="fc" id="L295">                .addComponent(comboBoxScriptSelector, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)</span>
<span class="fc" id="L296">                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)</span>
<span class="fc" id="L297">                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)</span>
<span class="fc" id="L298">                    .addComponent(startButton)</span>
<span class="fc" id="L299">                    .addComponent(DonateButton))</span>
<span class="fc" id="L300">                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)</span>
<span class="fc" id="L301">                .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, 41, javax.swing.GroupLayout.PREFERRED_SIZE)</span>
<span class="fc" id="L302">                .addGap(1, 1, 1))</span>
        );

<span class="fc" id="L305">        pack();</span>
<span class="fc" id="L306">    }// &lt;/editor-fold&gt;//GEN-END:initComponents</span>

    /**
     * the start button was pressed.
     */
    @Override
    public void StartButtonActionPerformed() {
<span class="nc" id="L313">        Log.level4Debug(&quot;StartButtonActionPerformed() Script Activated&quot;);</span>
<span class="nc" id="L314">        Log.level4Debug(&quot;Script known as &quot; + this.comboBoxScriptSelector.getSelectedItem().toString() + &quot; is running&quot;);</span>
<span class="nc" id="L315">        CASUALConnectionStatusMonitor.stop();</span>
<span class="nc" id="L316">        enableDisableControls(false);</span>
<span class="nc" id="L317">        String script = comboBoxScriptSelector.getSelectedItem().toString();</span>

        //execute
<span class="nc bnc" id="L320" title="All 2 branches missed.">        if (CASUALMain.getSession().CASPAC.getActiveScript().extractionMethod != 2) { //not on filesystem</span>
<span class="nc" id="L321">            Log.level4Debug(&quot;Loading internal resource: &quot; + script);</span>
<span class="nc" id="L322">            CASUALMain.getSession().CASPAC.getActiveScript().setScriptContinue(true);</span>
<span class="nc" id="L323">            new CASUALScriptParser().executeSelectedScript(caspac, true, CASUALMain.getSession());</span>
        }

<span class="nc" id="L326">    }</span>

    /**
     * sets the progress bar value.
     *
     * @param value value for progress bar
     */
    @Override
    public void setProgressBar(int value) {
<span class="nc" id="L335">        progressBar.setValue(value);</span>
<span class="nc" id="L336">        this.repaint();</span>
<span class="nc" id="L337">    }</span>

    /**
     * sets max value for progress bar
     *
     * @param value maximum
     */
    @Override
    public void setProgressBarMax(int value) {
<span class="nc" id="L346">        progressBar.setMaximum(value);</span>
<span class="nc" id="L347">    }</span>

    private void startButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_startButtonActionPerformed
<span class="nc" id="L350">        this.StartButtonActionPerformed();</span>
<span class="nc" id="L351">    }//GEN-LAST:event_startButtonActionPerformed</span>

    private void MenuItemShowDeveloperPaneActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_MenuItemShowDeveloperPaneActionPerformed
<span class="nc" id="L354">        CASUALJFrameDeveloperInstructions CDI = new CASUALJFrameDeveloperInstructions();</span>
<span class="nc" id="L355">        CDI.setVisible(true);</span>
<span class="nc" id="L356">    }//GEN-LAST:event_MenuItemShowDeveloperPaneActionPerformed</span>

    private void MenuItemOpenScriptActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_MenuItemOpenScriptActionPerformed

        String FileName;
<span class="nc" id="L361">        FileChooser1.setDialogTitle(&quot;Select a CASUAL \&quot;scr\&quot; file&quot;);</span>
<span class="nc" id="L362">        FileChooser1.setFileFilter(new CASUALScrFilter());</span>
<span class="nc" id="L363">        int returnVal = FileChooser1.showOpenDialog(this);</span>
<span class="nc bnc" id="L364" title="All 2 branches missed.">        if (returnVal == JFileChooser.APPROVE_OPTION) {</span>
            try {
<span class="nc" id="L366">                CASUALConnectionStatusMonitor.stop();</span>
<span class="nc" id="L367">                this.enableDisableControls(false);</span>
<span class="nc" id="L368">                FileName = FileChooser1.getSelectedFile().getCanonicalPath();</span>
<span class="nc" id="L369">                nonResourceFileName = this.getFilenameWithoutExtension(FileName);</span>
<span class="nc" id="L370">                Log.level2Information(&quot;Description for &quot; + nonResourceFileName);</span>
                try {
<span class="nc" id="L372">                    Log.level2Information(fileOperations.readFile(nonResourceFileName + &quot;.txt&quot;));</span>
<span class="nc" id="L373">                } catch (Exception e) {</span>
<span class="nc" id="L374">                    Log.level2Information(&quot;@textResourceNotFound&quot;);</span>
<span class="nc" id="L375">                }</span>
<span class="nc" id="L376">                this.comboBoxScriptSelector.setSelectedItem(nonResourceFileName);</span>
<span class="nc" id="L377">                comboBoxScriptSelector.setEditable(true);</span>
<span class="nc" id="L378">                ComboBoxValue = getFilenameWithoutExtension(FileName);</span>
<span class="nc" id="L379">                comboBoxScriptSelector.setSelectedItem(ComboBoxValue);</span>
<span class="nc" id="L380">                comboBoxScriptSelector.setEditable(false);</span>
<span class="nc" id="L381">                CASUALConnectionStatusMonitor.resumeAfterStop();</span>
<span class="nc" id="L382">            } catch (IOException ex) {</span>
<span class="nc" id="L383">                Log.errorHandler(ex);</span>
<span class="nc" id="L384">            }</span>

        }
<span class="nc" id="L387">    }//GEN-LAST:event_MenuItemOpenScriptActionPerformed</span>

    private void MenuItemShowAboutBoxActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_MenuItemShowAboutBoxActionPerformed
<span class="nc" id="L390">        CASUALJFrameAboutBox CAB = new CASUALJFrameAboutBox();</span>
<span class="nc" id="L391">        CAB.setVisible(true);</span>
<span class="nc" id="L392">    }//GEN-LAST:event_MenuItemShowAboutBoxActionPerformed</span>

    private void MenuItemExitActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_MenuItemExitActionPerformed
<span class="nc" id="L395">        CASUAL.CASUALMain.shutdown(0);</span>
<span class="nc" id="L396">    }//GEN-LAST:event_MenuItemExitActionPerformed</span>

    private void DonateButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_DonateButtonActionPerformed
<span class="nc" id="L399">        this.setInformationScrollBorderText(&quot;Donate&quot;);</span>
<span class="nc" id="L400">        int DResult = new CASUALMessageObject(&quot;Donate to the developers&quot;, &quot;This application was developed by &quot; + caspac.getBuild().getDeveloperName() + &quot; using CASUAL framework.\n&quot;</span>
<span class="nc" id="L401">                + &quot;Donations give developers a tangeble reason to continue quality software development\n&quot;).showTimeoutDialog(</span>
                        60, //timeout
                        null, //parentComponent
                        //DisplayTitle
                        javax.swing.JOptionPane.OK_OPTION, // Options buttons
                        javax.swing.JOptionPane.INFORMATION_MESSAGE, //Icon
<span class="nc" id="L407">                        new String[]{&quot;Donate To CASUAL&quot;, &quot;Donate To &quot; + caspac.getBuild().getDeveloperName()}, // option buttons</span>
                        &quot;No&quot;); //Default{
<span class="nc bnc" id="L409" title="All 2 branches missed.">        if (DResult == 0) {</span>
<span class="nc" id="L410">            launchLink(&quot;https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&amp;hosted_button_id=ZYM99W5RHRY3Y&quot;);</span>
<span class="nc bnc" id="L411" title="All 2 branches missed.">        } else if (DResult == 1) {</span>
<span class="nc" id="L412">            launchLink(caspac.getBuild().getDonateLink());</span>
        }
<span class="nc" id="L414">    }//GEN-LAST:event_DonateButtonActionPerformed</span>
    /**
     * sets the window visible.
     *
     * @param v set true if window should be visible.
     */
    @Override
    public void setVisible(boolean v) {
<span class="fc" id="L422">        Log.level3Verbose(&quot;Setting window visibility&quot; + v);</span>
<span class="fc" id="L423">        setLocationRelativeTo(null);</span>
<span class="fc" id="L424">        super.setVisible(v);</span>
<span class="fc" id="L425">    }</span>

    private void comboBoxScriptSelectorPopupMenuWillBecomeInvisible(javax.swing.event.PopupMenuEvent evt) {//GEN-FIRST:event_comboBoxScriptSelectorPopupMenuWillBecomeInvisible
<span class="nc" id="L428">        CASUALConnectionStatusMonitor.stop();</span>
<span class="nc" id="L429">        this.enableDisableControls(false);</span>
<span class="nc" id="L430">        CASUALStartupTasks.lockGUIunzip = true;</span>
<span class="nc" id="L431">        String selectedScript = comboBoxScriptSelector.getSelectedItem().toString();</span>
<span class="nc" id="L432">        Log.level4Debug(&quot;hiding script selector TargetScript: &quot; + selectedScript);</span>
<span class="nc" id="L433">        caspac.setActiveScript(caspac.getScriptByName(selectedScript));</span>
<span class="nc" id="L434">        Log.level2Information(caspac.getActiveScript().getDiscription());</span>
<span class="nc" id="L435">        caspac.startAndWaitForUnzip();</span>

<span class="nc" id="L437">        CASUALStartupTasks.lockGUIunzip = false;</span>
<span class="nc" id="L438">        CASUALConnectionStatusMonitor.resumeAfterStop();</span>


<span class="nc" id="L441">    }//GEN-LAST:event_comboBoxScriptSelectorPopupMenuWillBecomeInvisible</span>

    private void jMenuItem1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jMenuItem1ActionPerformed
<span class="nc" id="L444">        CASUALJFrameLog CASUALLogJFrame = new CASUALJFrameLog();</span>
<span class="nc" id="L445">        CASUALLogJFrame.setVisible(true);</span>
<span class="nc" id="L446">    }//GEN-LAST:event_jMenuItem1ActionPerformed</span>

    private void formWindowClosing(java.awt.event.WindowEvent evt) {//GEN-FIRST:event_formWindowClosing
<span class="nc" id="L449">        this.dispose();</span>
<span class="nc" id="L450">    }//GEN-LAST:event_formWindowClosing</span>
<span class="fc" id="L451">    boolean buttonEnableStage = false;</span>
    private void startButtonMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_startButtonMouseClicked
<span class="nc" id="L453">    }//GEN-LAST:event_startButtonMouseClicked</span>

    private void startButtonMouseExited(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_startButtonMouseExited
<span class="nc" id="L456">    }//GEN-LAST:event_startButtonMouseExited</span>

    private void StatusLabelMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_StatusLabelMouseClicked
<span class="nc bnc" id="L459" title="All 2 branches missed.">        if (buttonEnableStage) {</span>
<span class="nc" id="L460">            Log.level4Debug(&quot;Control system override active.  User has manually enabled controls&quot;);</span>
<span class="nc" id="L461">            startButton.setEnabled(buttonEnableStage);</span>
<span class="nc" id="L462">            this.comboBoxScriptSelector.setEnabled(buttonEnableStage);</span>
<span class="nc" id="L463">            this.startButton.setText(java.util.ResourceBundle.getBundle(&quot;SCRIPTS/-build&quot;).getString(&quot;Window.ExecuteButtonText&quot;));</span>
<span class="nc" id="L464">            buttonEnableStage = false;</span>

        }
<span class="nc bnc" id="L467" title="All 4 branches missed.">        if (!startButton.isEnabled() &amp;&amp; !CASUALStartupTasks.lockGUIformPrep) {</span>
<span class="nc" id="L468">            Log.level4Debug(&quot;Control system override clicked&quot;);</span>
<span class="nc" id="L469">            startButton.setText(&quot;Click again to enable all controls&quot;);</span>
<span class="nc" id="L470">            buttonEnableStage = true;</span>

        }
<span class="nc" id="L473">    }//GEN-LAST:event_StatusLabelMouseClicked</span>

    private void StatusLabelMouseExited(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_StatusLabelMouseExited
        try {
<span class="nc" id="L477">            this.startButton.setText(java.util.ResourceBundle.getBundle(&quot;SCRIPTS/-build&quot;).getString(&quot;Window.ExecuteButtonText&quot;));</span>
<span class="nc" id="L478">        } catch (java.util.MissingResourceException ex) {</span>
            try {
<span class="nc" id="L480">                this.startButton.setText(java.util.ResourceBundle.getBundle(&quot;SCRIPTS\\-build&quot;).getString(&quot;Window.ExecuteButtonText&quot;));</span>
<span class="nc" id="L481">            } catch (java.util.MissingResourceException er) {</span>
<span class="nc" id="L482">                this.startButton.setText(CASUALMain.getSession().CASPAC.getBuild().getExecuteButtonText());</span>
<span class="nc" id="L483">            }</span>
<span class="nc" id="L484">        }</span>
<span class="nc" id="L485">        buttonEnableStage = false;</span>
<span class="nc" id="L486">    }//GEN-LAST:event_StatusLabelMouseExited</span>

    private void comboBoxScriptSelectorActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_comboBoxScriptSelectorActionPerformed
<span class="fc" id="L489">    }//GEN-LAST:event_comboBoxScriptSelectorActionPerformed</span>

    private static void launchLink(String Link) {
<span class="nc" id="L492">        new LinkLauncher(Link).launch();</span>
<span class="nc" id="L493">    }</span>

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton DonateButton;
    private javax.swing.JFileChooser FileChooser1;
    private javax.swing.JMenuItem MenuItemExit;
    private javax.swing.JMenuItem MenuItemOpenScript;
    private javax.swing.JMenuItem MenuItemShowAboutBox;
    private javax.swing.JMenuItem MenuItemShowDeveloperPane;
    private javax.swing.JTextPane ProgressArea;
    private javax.swing.JLabel StatusLabel;
    private javax.swing.JComboBox&lt;String&gt; comboBoxScriptSelector;
    private javax.swing.JScrollPane informationScrollPanel;
    private javax.swing.JMenu jMenu1;
    private javax.swing.JMenu jMenu2;
    private javax.swing.JMenuBar jMenuBar1;
    private javax.swing.JMenuItem jMenuItem1;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JSeparator jSeparator1;
    private javax.swing.JProgressBar progressBar;
    private javax.swing.JButton startButton;
    private javax.swing.JLabel windowBanner;
    // End of variables declaration//GEN-END:variables

    /**
     * changes the label icon
     *
     * @param Icon resource to be displayed
     * @param Text text if icon is missing
     */
    public void setStatusLabelIcon(String Icon, String Text) {
<span class="nc" id="L524">        StatusLabel.setIcon(createImageIcon(Icon, Text));</span>
<span class="nc" id="L525">    }</span>

    /**
     * takes a resource and turns it into an ImageIcon
     *
     * @param path pat to resource
     * @param description icon description
     * @return an icon
     */
    protected ImageIcon createImageIcon(String path, String description) {
<span class="nc" id="L535">        java.net.URL imgURL = getClass().getResource(path);</span>
<span class="nc bnc" id="L536" title="All 2 branches missed.">        if (imgURL != null) {</span>
<span class="nc" id="L537">            return new ImageIcon(imgURL, description);</span>
        } else {
<span class="nc" id="L539">            System.err.println(&quot;Couldn't find file: &quot; + path);</span>
<span class="nc" id="L540">            return null;</span>
        }
    }

    private String getFilenameWithoutExtension(String FileName) {

<span class="nc bnc" id="L546" title="All 2 branches missed.">        if (FileName.endsWith(&quot;.scr&quot;)) {</span>
<span class="nc" id="L547">            FileName = FileName.replace(&quot;.scr&quot;, &quot;&quot;);</span>
        }
<span class="nc" id="L549">        return FileName;</span>

    }

    /**
     * sets the message label text
     *
     * @param text label text
     */
    @Override
    public void setUserSubMessage(String text) {
<span class="nc" id="L560">        this.StatusLabel.setText(text);</span>
<span class="nc" id="L561">    }</span>

    /**
     * gets the control status
     *
     * @return true if enabled
     */
    public boolean getControlStatus() {
<span class="nc bnc" id="L569" title="All 4 branches missed.">        return startButton.isEnabled() &amp;&amp; comboBoxScriptSelector.isEnabled();</span>
    }

    /**
     * sets controls status
     *
     * @param status commanded value
     * @param number number of devices 
     * @param  mode mode which is commanded
     * @return true if enabled false if not
     */
    @Override
    public boolean setControlStatus(boolean status,int number, String mode) {
<span class="nc bnc" id="L582" title="All 3 branches missed.">        switch (number){</span>
<span class="nc" id="L583">            case 0: this.deviceDisconnected();</span>
<span class="nc" id="L584">                break;</span>
<span class="nc" id="L585">            case 1: this.deviceConnected(mode);</span>
<span class="nc" id="L586">                break;</span>
<span class="nc" id="L587">            default: this.deviceMultipleConnected(number);</span>
                break;
        }
        
<span class="nc" id="L591">        return true;</span>
    }

    boolean enableDisableControls( boolean requestedStatus){
<span class="nc bnc" id="L595" title="All 2 branches missed.">        if (!CASUALStartupTasks.scriptRunLock.isComplete()) {</span>
<span class="nc" id="L596">            return false;</span>
        }
        //LockOnADBDisconnect tells CASUAL to disregard ADB status.
<span class="nc bnc" id="L599" title="All 2 branches missed.">        if (caspac != null) {</span>
<span class="nc bnc" id="L600" title="All 2 branches missed.">            if (caspac.getBuild().isAlwaysEnableControls()) {</span>
<span class="nc" id="L601">                requestedStatus = true; //if LockOnADBDisconnect is false then just enable controls</span>
<span class="nc" id="L602">                startButton.setEnabled(requestedStatus);</span>
<span class="nc" id="L603">                comboBoxScriptSelector.setEnabled(requestedStatus);</span>
<span class="nc" id="L604">                return true;</span>
            }
        }
<span class="nc bnc" id="L607" title="All 2 branches missed.">        if (!CASUALStartupTasks.lockGUIformPrep) {</span>
<span class="nc bnc" id="L608" title="All 2 branches missed.">            if (!CASUALStartupTasks.lockGUIunzip) {</span>
<span class="nc bnc" id="L609" title="All 2 branches missed.">                if (!CASUALStartupTasks.scriptRunLock.isAlive()) {</span>
<span class="nc" id="L610">                    startButton.setEnabled(requestedStatus);</span>
<span class="nc" id="L611">                    comboBoxScriptSelector.setEnabled(requestedStatus);</span>
<span class="nc" id="L612">                    Log.level4Debug(&quot;Controls Enabled status: &quot; + requestedStatus);</span>
                } else {
<span class="nc" id="L614">                    Log.level4Debug(&quot;Control Change requested but script is running&quot;);</span>
                }
            } else {
<span class="nc" id="L617">                Log.level4Debug(&quot;Control Change requested but unzip has not yet finished&quot;);</span>
            }
        } else {
<span class="nc" id="L620">            Log.level4Debug(&quot;Control Change requested but GUI is not ready is set.&quot;);</span>
        }
<span class="nc" id="L622">        return checkGUIStatus(requestedStatus);</span>
        
    }
       
       
       
    private boolean checkGUIStatus(boolean expectedStatus) {
<span class="nc bnc" id="L629" title="All 2 branches missed.">        if (CASUALSessionData.isGUIIsAvailable()) {</span>
<span class="nc bnc" id="L630" title="All 2 branches missed.">            return expectedStatus == this.startButton.isEnabled();</span>
<span class="nc bnc" id="L631" title="All 2 branches missed.">        } else if (CASUALSessionData.isGUIIsAvailable()) {  //if gui is not available yet</span>
<span class="nc" id="L632">            return false;</span>
        }
<span class="nc" id="L634">        return true; //gui is not used for this CASUAL.</span>

    }

    /**
     * sets the main window banner text if an image is not used
     *
     * @param text text to display as banner
     */
    @Override
    public void setWindowBannerText(String text) {
<span class="fc" id="L645">        windowBanner.setText(text);</span>
<span class="fc" id="L646">    }</span>

    /**
     * sets &quot;do it!&quot; button text
     *
     * @param text text for main execution button
     */
    @Override
    public void setStartButtonText(String text) {
<span class="nc" id="L655">        startButton.setText(text);</span>
<span class="nc" id="L656">    }</span>

    /**
     * sets window banner image
     *
     * @param icon image to display
     * @param text text if image cannot be displayed
     */
    public void setWindowBannerImage(BufferedImage icon, String text) {
<span class="fc" id="L665">        windowBanner.setIcon(new ImageIcon(icon, text));</span>

<span class="fc" id="L667">    }</span>

    @Override
    public void dispose() {
<span class="nc" id="L671">        this.setVisible(false);</span>
<span class="nc" id="L672">        super.dispose();</span>
<span class="nc bnc" id="L673" title="All 2 branches missed.">        if (CASUALSessionData.getGUI() == this) {</span>
<span class="nc" id="L674">            CASUALSessionData.setGUI(null);</span>
        }
<span class="nc" id="L676">        CASUAL.CASUALMain.shutdown(0);</span>
<span class="nc" id="L677">        System.exit(0);</span>
<span class="nc" id="L678">    }</span>

    /**
     * window is closing
     *
     * @param e closing event
     */
    public void windowCosing(WindowEvent e) {
<span class="nc" id="L686">        this.setVisible(false);</span>
<span class="nc" id="L687">        this.dispose();</span>
<span class="nc" id="L688">        CASUAL.CASUALMain.shutdown(0);</span>
<span class="nc" id="L689">    }</span>

    @Override
    public void setScript(Script s) {
<span class="nc" id="L693">    }</span>

    @SuppressWarnings({&quot;rawtypes&quot;, &quot;unchecked&quot;}) //needed because JDK6 does not support type-modified JComboBoxes
    @Override
    public void setCASPAC(Caspac caspac) {
<span class="fc" id="L698">        this.setInformationScrollBorderText(&quot;Important Information&quot;);</span>
<span class="fc" id="L699">        this.caspac = caspac;</span>
<span class="fc" id="L700">        isReady = true;</span>

<span class="fc" id="L702">        Log.level2Information(caspac.getOverview());</span>
        /* if (caspac.build.usePictureForBanner) {
         //setup banner with CASPAC.logo
         }*/
<span class="pc bpc" id="L706" title="1 of 2 branches missed.">        if (caspac.getBuild().isAlwaysEnableControls()) {</span>
<span class="nc" id="L707">            enableDisableControls(true);</span>
        }
<span class="fc" id="L709">        this.setTitle(caspac.getBuild().getWindowTitle() + &quot; -- CASUAL R&quot; + CASUAL.CASUALTools.getSVNVersion());</span>
<span class="pc bpc" id="L710" title="1 of 2 branches missed.">        if (caspac.getScripts().size() &gt; 0) {</span>
<span class="fc bfc" id="L711" title="All 2 branches covered.">            for (Script s : caspac.getScripts()) {</span>
<span class="fc" id="L712">                boolean addScript = true;</span>
<span class="pc bpc" id="L713" title="1 of 2 branches missed.">                for (int i = 0; i &lt; comboBoxScriptSelector.getItemCount(); i++) {</span>
<span class="nc bnc" id="L714" title="All 2 branches missed.">                    if (comboBoxScriptSelector.getItemAt(i).equals(s.getName())) {</span>
<span class="nc" id="L715">                        addScript = false;</span>
                    }
                }
<span class="pc bpc" id="L718" title="1 of 2 branches missed.">                if (addScript) {</span>
<span class="fc" id="L719">                    this.comboBoxScriptSelector.addItem(s.getName());</span>
                }

<span class="fc" id="L722">                Log.level4Debug(&quot;adding &quot; + s.getName() + &quot; to UI&quot;);</span>
<span class="fc" id="L723">            }</span>
<span class="pc bpc" id="L724" title="1 of 2 branches missed.">            if (caspac.getActiveScript() != null) {</span>
<span class="fc" id="L725">                Log.level2Information(caspac.getScriptByName(this.comboBoxScriptSelector.getSelectedItem().toString()).getDiscription());</span>
            }
        }
<span class="pc bpc" id="L728" title="1 of 2 branches missed.">        if (comboBoxScriptSelector.getItemCount() &lt; 1) {</span>
            // comboBoxScriptSelector.setVisible(false);
        }
<span class="fc" id="L731">        this.startButton.setText(caspac.getBuild().getExecuteButtonText());</span>
<span class="fc" id="L732">        setWindowBannerText(&quot;&quot;);</span>
<span class="pc bpc" id="L733" title="2 of 4 branches missed.">        if (caspac.getLogo() != null &amp;&amp; caspac.getLogo().getMinX() &lt; 40) {</span>
<span class="fc" id="L734">            setWindowBannerImage(caspac.getLogo(), caspac.getBuild().getBannerText());</span>
        } else {
<span class="nc" id="L736">            setWindowBannerText(caspac.getBuild().getBannerText());</span>
        }
<span class="fc" id="L738">    }</span>
<span class="fc" id="L739">    long time = System.currentTimeMillis();</span>

    @Override
    public void setInformationScrollBorderText(String title) {
<span class="fc" id="L743">        Border b = informationScrollPanel.getBorder();</span>
<span class="fc" id="L744">        ((TitledBorder) b).setTitle(title);</span>
<span class="pc bpc" id="L745" title="1 of 2 branches missed.">        if (System.currentTimeMillis() &gt; time + 100) {</span>
<span class="fc" id="L746">            repaint();</span>
<span class="fc" id="L747">            time = System.currentTimeMillis();</span>
        }
<span class="fc" id="L749">    }</span>

<span class="fc" id="L751">    static boolean deviceConnected=false;</span>
    public void deviceConnected(String mode) {
        
<span class="nc" id="L754">        setStatusLabelIcon(&quot;/GUI/development/resources/images/DeviceConnected.png&quot;, &quot;Device Connected&quot;);</span>
<span class="nc" id="L755">        setUserSubMessage(&quot;Target Acquired&quot;);</span>
<span class="nc" id="L756">        AudioHandler.playSound(&quot;/GUI/development/resources/sounds/Connected-SystemReady.wav&quot;);</span>
<span class="nc" id="L757">        deviceConnected=true;</span>
<span class="nc bnc" id="L758" title="All 4 branches missed.">        if (this.isReady &amp;&amp; deviceConnected){</span>
<span class="nc" id="L759">            this.enableDisableControls(true);</span>
        }

<span class="nc" id="L762">    }</span>

    public void deviceDisconnected() {
<span class="nc" id="L765">        deviceConnected=false;</span>
<span class="nc" id="L766">        setStatusLabelIcon(&quot;/GUI/development/resources/images/DeviceDisconnected.png&quot;, &quot;Device Not Detected&quot;);</span>
<span class="nc" id="L767">        AudioHandler.playSound(&quot;/GUI/development/resources/sounds/Disconnected.wav&quot;);</span>
<span class="nc" id="L768">    }</span>

    public void deviceMultipleConnected(int numberOfDevicesConnected) {
<span class="nc" id="L771">        deviceConnected=false;</span>
<span class="nc" id="L772">        setStatusLabelIcon(&quot;/GUI/development/resources/images/TooManyDevices.png&quot;, &quot;Target Acquired&quot;);</span>
<span class="nc" id="L773">        String[] URLs = {&quot;/GUI/development/resources/sounds/&quot; + String.valueOf(numberOfDevicesConnected) + &quot;.wav&quot;, &quot;/GUI/development/resources/sounds/DevicesDetected.wav&quot;};</span>
<span class="nc" id="L774">        AudioHandler.playMultipleInputStreams(URLs);</span>
<span class="nc" id="L775">    }</span>

    public void notificationCASUALSound() {
<span class="fc" id="L778">        AudioHandler.playSound(&quot;/GUI/development/resources/sounds/CASUAL.wav&quot;);</span>
<span class="fc" id="L779">    }</span>

    @Override
    public String displayMessage(CASUALMessageObject messageObject) {
<span class="fc" id="L783">        int messageType = messageObject.getMessageType();</span>
<span class="fc" id="L784">        String title = messageObject.title;</span>
<span class="fc" id="L785">        String messageText = messageObject.messageText;</span>
<span class="fc" id="L786">        String retval = &quot;&quot;;</span>
<span class="fc" id="L787">        Log.Level1Interaction(messageObject.toString());</span>
<span class="pc bpc" id="L788" title="3 of 10 branches missed.">        switch (messageType) {</span>
            case INTERACTION_TIME_OUT:
<span class="fc" id="L790">                return showTimeOutInteraction(messageObject, messageText, title);</span>
            case INTERACTION_ACTION_REUIRED:
<span class="fc" id="L792">                AudioHandler.playSound(&quot;/GUI/development/resources/sounds/UserActionIsRequired.wav&quot;);</span>
<span class="fc" id="L793">                return showActionRequiredInteraction(messageText, title);</span>
            //break;// unreachable

            case INTERACTION_USER_CANCEL_OPTION:
<span class="fc" id="L797">                AudioHandler.playSound(&quot;/GUI/development/resources/sounds/RequestToContinue.wav&quot;);</span>
<span class="fc" id="L798">                return showUserCancelOptionInteraction(title, messageText);               //break; unreachable</span>

            case INTERACTION_USER_NOTIFICATION:
<span class="fc" id="L801">                AudioHandler.playSound(&quot;/GUI/development/resources/sounds/Notification.wav&quot;);</span>
<span class="fc" id="L802">                showUserNotificationInteraction(title, messageText);</span>
<span class="fc" id="L803">                break;</span>

            case INTERACTION_SHOW_INFORMATION:
<span class="fc" id="L806">                showInformationInteraction(messageText, title);</span>
<span class="fc" id="L807">                break;</span>

            case INTERACTION_SHOW_ERROR:
<span class="fc" id="L810">                showErrorInteraction(messageText, title);</span>
<span class="fc" id="L811">                break;</span>

            case INTERACTION_SHOW_YES_NO:
<span class="nc" id="L814">                return showYesNoInteraction(title, messageText);</span>
            //break; unreachable

            case INTERACTION_INPUT_DIALOG:
<span class="fc" id="L818">                AudioHandler.playSound(&quot;/GUI/development/resources/sounds/InputRequested.wav&quot;);</span>
<span class="fc" id="L819">                return showInputDialog(title, messageText);</span>
            //break; unreachable

            case INTERACTION_COMMAND_NOTIFICATION:
<span class="nc" id="L823">                showUserNotificationInteraction(title, messageText);</span>
<span class="nc" id="L824">                return messageText;</span>
        }
<span class="fc" id="L826">        return retval;</span>
    }

    /**
     * grabs input from CASUALMain.getSession().in (usually stdin).
     *
     * @return string value containing user input truncated by enter key.
     */
    public String getCommandLineInput() {
        try {
<span class="fc" id="L836">            Log.out.flush();</span>
<span class="fc" id="L837">            String s = CASUALMain.getSession().in.readLine();</span>
<span class="pc bpc" id="L838" title="1 of 2 branches missed.">            if (s == null) {</span>
<span class="nc bnc" id="L839" title="All 2 branches missed.">                while (s == null) {</span>
<span class="nc" id="L840">                    s = CASUALMain.getSession().in.readLine();</span>
                }
            }
<span class="fc" id="L843">            return s;</span>
<span class="nc" id="L844">        } catch (IOException ex) {</span>
<span class="nc" id="L845">            Log.errorHandler(ex);</span>
<span class="nc" id="L846">            return &quot;&quot;;</span>
        }
    }

    private void waitForStandardInputBeforeContinuing() {
<span class="fc" id="L851">        getCommandLineInput();</span>
<span class="fc" id="L852">    }</span>

    private String showTimeOutInteraction(CASUALMessageObject messageObject, String messageText, String title) {
<span class="pc bpc" id="L855" title="1 of 2 branches missed.">        if (CASUALSessionData.isGUIIsAvailable() &amp;&amp; !isDummyGUI) {</span>
<span class="fc" id="L856">            return Integer.toString(new TimeOutOptionPane().timeoutDialog(messageObject.timeoutPresetTime, (Component) CASUALSessionData.getGUI(), messageText, title, messageObject.timeoutOptionType, messageObject.timeoutMessageType, messageObject.timeoutOptions, messageObject.timeoutInitialValue));</span>
        } else {
<span class="nc" id="L858">            Log.Level1Interaction(&quot;[STANDARDMESSAGE]&quot; + title + &quot;\n&quot; + messageText + &quot;\n[RESPONSEEXPECTED]&quot;);</span>
<span class="nc" id="L859">            String s = getCommandLineInput();</span>
<span class="nc bnc" id="L860" title="All 4 branches missed.">            if (s == null || s.isEmpty()) {</span>
<span class="nc" id="L861">                return &quot;0&quot;;</span>
            }
<span class="nc" id="L863">            return &quot;1&quot;;</span>
        }
    }

    private String showActionRequiredInteraction(String messageText, String title) throws HeadlessException {
        String retval;
<span class="fc" id="L869">        Log.level4Debug(&quot;Displaying Action Is Required Dialog:&quot; + messageText);</span>
<span class="fc" id="L870">        int n = 9999;</span>
<span class="pc bpc" id="L871" title="1 of 2 branches missed.">        if (CASUALSessionData.isGUIIsAvailable() &amp;&amp; !isDummyGUI) {</span>
<span class="nc" id="L872">            Object[] Options = {&quot;I did it&quot;, &quot;I didn't do it&quot;};</span>
<span class="nc" id="L873">            messageText = &quot;&lt;html&gt;&quot; + messageText.replace(&quot;\\n&quot;, &quot;&lt;BR&gt;&quot;);</span>

<span class="nc" id="L875">            n = JOptionPane.showOptionDialog((Component) CASUALSessionData.getGUI(),</span>
                    messageText,
                    &quot;Dont click through this!&quot;,
                    JOptionPane.YES_NO_OPTION,
                    JOptionPane.QUESTION_MESSAGE,
                    null,
                    Options,
                    Options[1]);
<span class="nc" id="L883">        } else {</span>
<span class="fc bfc" id="L884" title="All 4 branches covered.">            while (n != 0 &amp;&amp; n != 1) {</span>
<span class="fc" id="L885">                Log.Level1Interaction(&quot;[ACTIONREQUIRED][Q or RETURN]&quot; + title + &quot;\n&quot; + messageText + &quot;\npress Q to quit&quot; + &quot;\n[RESPONSEEXPECTED]&quot;);</span>
<span class="fc" id="L886">                retval = getCommandLineInput();</span>
<span class="pc bpc" id="L887" title="2 of 6 branches missed.">                if (!retval.equals(&quot;q&quot;) &amp;&amp; !retval.equals(&quot;Q&quot;) &amp;&amp; !retval.isEmpty()) {</span>
<span class="nc" id="L888">                    n = new CASUALMessageObject(messageText).showActionRequiredDialog();</span>
<span class="pc bpc" id="L889" title="1 of 4 branches missed.">                } else if (retval.equals(&quot;Q&quot;) || retval.equals(&quot;q&quot;)) {</span>
<span class="fc" id="L890">                    n = 1;</span>
                } else {
<span class="fc" id="L892">                    n = 0;</span>
                }
            }
        }
<span class="fc" id="L896">        return Integer.toString(n);</span>
        //break;// unreachable
    }

    private String showUserCancelOptionInteraction(String title, String messageText) throws HeadlessException {
        int cancelReturn;
<span class="fc" id="L902">        Object[] Options = {&quot;Continue&quot;, &quot;Stop&quot;};</span>
<span class="pc bpc" id="L903" title="1 of 2 branches missed.">        if (CASUALSessionData.isGUIIsAvailable() &amp;&amp; !isDummyGUI) {</span>
<span class="nc bnc" id="L904" title="All 2 branches missed.">            if (title == null) {</span>
<span class="nc" id="L905">                cancelReturn = JOptionPane.showOptionDialog(this,</span>
                        messageText,
                        &quot;Do you wish to continue?&quot;,
                        JOptionPane.YES_NO_OPTION,
                        JOptionPane.QUESTION_MESSAGE,
                        null,
                        Options,
                        Options[1]);
            } else {
<span class="nc" id="L914">                cancelReturn = JOptionPane.showOptionDialog(this,</span>
                        messageText,
                        title,
                        JOptionPane.YES_NO_OPTION,
                        JOptionPane.QUESTION_MESSAGE,
                        null,
                        Options,
                        Options[1]);
            }
        } else {
<span class="fc" id="L924">            Log.Level1Interaction(&quot;[CANCELOPTION][Q or RETURN]&quot; + title + &quot;\n&quot; + messageText + &quot;\npress Q to quit&quot; + &quot;\n[RESPONSEEXPECTED]&quot;);</span>
<span class="fc" id="L925">            String s = this.getCommandLineInput();</span>
<span class="pc bpc" id="L926" title="1 of 4 branches missed.">            if (s.equals(&quot;q&quot;) || s.equals(&quot;Q&quot;)) {</span>
<span class="fc" id="L927">                cancelReturn = 1;</span>
            } else {
<span class="fc" id="L929">                cancelReturn = 0;</span>
            }
        }
<span class="fc" id="L932">        return Integer.toString(cancelReturn);</span>
        //break; unreachable
    }

    private void showUserNotificationInteraction(String title, String messageText) throws HeadlessException {
<span class="fc" id="L937">        Log.level4Debug(&quot;Showing User Notification Dialog -Title:&quot; + title + &quot; -message:&quot; + messageText);</span>
<span class="pc bpc" id="L938" title="1 of 2 branches missed.">        if (CASUALSessionData.isGUIIsAvailable() &amp;&amp; !isDummyGUI) {</span>
<span class="nc bnc" id="L939" title="All 2 branches missed.">            if (title != null) {</span>
<span class="nc" id="L940">                JOptionPane.showMessageDialog(this,</span>
                        messageText,
                        title,
                        JOptionPane.INFORMATION_MESSAGE);
            } else {
<span class="nc" id="L945">                JOptionPane.showMessageDialog(this,</span>
                        messageText,
                        &quot;Information&quot;,
                        JOptionPane.INFORMATION_MESSAGE);
            }
        } else {
<span class="fc" id="L951">            Log.Level1Interaction(&quot;[NOTIFICATION][RETURN]&quot; + title + &quot;\n&quot; + messageText + &quot;  Press any key to continue.&quot; + &quot;\n[RESPONSEEXPECTED]&quot;);</span>
<span class="fc" id="L952">            waitForStandardInputBeforeContinuing();</span>
        }
<span class="fc" id="L954">    }</span>

    private void showInformationInteraction(String messageText, String title) throws HeadlessException {
<span class="pc bpc" id="L957" title="1 of 2 branches missed.">        if (CASUALSessionData.isGUIIsAvailable() &amp;&amp; !isDummyGUI) {</span>
<span class="nc" id="L958">            JOptionPane.showMessageDialog(this,</span>
                    messageText, title,
                    JOptionPane.INFORMATION_MESSAGE);
        } else {
<span class="fc" id="L962">            Log.Level1Interaction(&quot;[INFOMESSAGE][RETURN]&quot; + title + &quot;\n&quot; + messageText + &quot;  Press any key to continue.&quot; + &quot;\n[RESPONSEEXPECTED]&quot;);</span>
<span class="fc" id="L963">            waitForStandardInputBeforeContinuing();</span>
        }
<span class="fc" id="L965">    }</span>

    private void showErrorInteraction(String messageText, String title) throws HeadlessException {
<span class="pc bpc" id="L968" title="1 of 2 branches missed.">        if (CASUALSessionData.isGUIIsAvailable() &amp;&amp; !isDummyGUI) {</span>
<span class="nc" id="L969">            JOptionPane.showMessageDialog(this, messageText, title, ERROR_MESSAGE);</span>
        } else {
<span class="fc" id="L971">            Log.Level1Interaction(&quot;[ERRORMESSAGE][RETURN]&quot; + title + &quot;\n&quot; + messageText + &quot;  Press any key to continue.&quot; + &quot;\n[RESPONSEEXPECTED]&quot;);</span>
<span class="fc" id="L972">            waitForStandardInputBeforeContinuing();</span>
        }
<span class="fc" id="L974">    }</span>

    private String showYesNoInteraction(String title, String messageText) throws HeadlessException {
<span class="nc" id="L977">        Log.level4Debug(&quot;Displaying Yes/No Dialog: &quot; + title + &quot; message: &quot; + messageText + &quot;\n[RESPONSEEXPECTED]&quot;);</span>
<span class="nc bnc" id="L978" title="All 2 branches missed.">        if (CASUALSessionData.isGUIIsAvailable() &amp;&amp; !isDummyGUI) {</span>
<span class="nc bnc" id="L979" title="All 2 branches missed.">            if (title == null) {</span>
<span class="nc" id="L980">                title = &quot;Yes or No&quot;;</span>
            }
<span class="nc bnc" id="L982" title="All 2 branches missed.">            boolean val = (JOptionPane.showConfirmDialog((Component)  this,</span>
                    messageText,
                    title,
                    JOptionPane.YES_NO_OPTION) == YES_OPTION);
<span class="nc bnc" id="L986" title="All 2 branches missed.">            return val ? &quot;true&quot; : &quot;false&quot;;</span>
        } else {
<span class="nc bnc" id="L988" title="All 2 branches missed.">            if (title == null) {</span>
<span class="nc" id="L989">                title = &quot;&quot;;</span>
            } else {
<span class="nc" id="L991">                title += &quot;\n&quot;;</span>
            }
            //display the messageText
<span class="nc" id="L994">            Log.Level1Interaction(&quot;[YESNOOPTION][RETURN or n]&quot; + title + &quot;\n&quot; + messageText + &quot;\npress N for no&quot; + &quot;\n[RESPONSEEXPECTED]&quot;);</span>
<span class="nc" id="L995">            String s = this.getCommandLineInput();</span>
<span class="nc bnc" id="L996" title="All 4 branches missed.">            if (s.equals(&quot;n&quot;) || s.equals(&quot;N&quot;)) {</span>
<span class="nc" id="L997">                return &quot;false&quot;;</span>
            } else {
<span class="nc" id="L999">                return &quot;true&quot;;</span>
            }
        }
    }

    private String showInputDialog(String title, String messageText) throws HeadlessException {
<span class="fc" id="L1005">        Log.level4Debug(&quot;Requesting User Input.. Title:&quot; + title + &quot; -message:&quot; + messageText + &quot;\n[RESPONSEEXPECTED]&quot;);</span>
<span class="fc" id="L1006">        messageText = &quot;&lt;html&gt;&quot; + messageText.replace(&quot;\\n&quot;, &quot;\n&quot;);</span>
<span class="pc bpc" id="L1007" title="1 of 2 branches missed.">        if (CASUALSessionData.isGUIIsAvailable() &amp;&amp; !isDummyGUI) {</span>
<span class="nc bnc" id="L1008" title="All 2 branches missed.">            if (title == null) {</span>
<span class="nc" id="L1009">                return JOptionPane.showInputDialog(this, messageText, &quot;Input Required&quot;, JOptionPane.QUESTION_MESSAGE);</span>
            } else {
<span class="nc" id="L1011">                return JOptionPane.showInputDialog(this, messageText, title, JOptionPane.QUESTION_MESSAGE);</span>
            }
        } else {
<span class="fc" id="L1014">            Log.Level1Interaction(&quot;[INPUT][ANY]&quot; + title + messageText + &quot;\n input:&quot;);</span>
<span class="fc" id="L1015">            return getCommandLineInput();</span>
        }
        //break; unreachable
    }

    @Override
    public boolean isReady() {
<span class="fc" id="L1022">        return isReady;</span>
    }

    @Override
    public boolean isDummyGUI() {
<span class="nc" id="L1027">        return isDummyGUI;</span>
    }

    @Override
    public void setReady(boolean ready) {
<span class="fc" id="L1032">        isReady = ready;</span>
<span class="pc bpc" id="L1033" title="1 of 4 branches missed.">        if (this.isReady &amp;&amp; deviceConnected){</span>
<span class="nc" id="L1034">            this.enableDisableControls(true);</span>
        }
<span class="fc" id="L1036">    }</span>

    @Override
    public void setBlocksUnzipped(String i) {
<span class="nc" id="L1040">        this.setInformationScrollBorderText(&quot;Unzipping:&quot; + i);</span>
<span class="nc" id="L1041">    }</span>

    @Override
    public void sendString(String string) {
<span class="nc" id="L1045">        ProgressArea.setText(ProgressArea.getText().concat(string));</span>
<span class="nc" id="L1046">        ProgressArea.setCaretPosition(ProgressArea.getDocument().getLength());</span>
<span class="nc" id="L1047">    }</span>

    @Override
    public void sendProgress(String data) {
        try {
<span class="nc" id="L1052">            char[] dataArray = data.toCharArray();</span>
<span class="nc bnc" id="L1053" title="All 2 branches missed.">            for (int c : dataArray) {</span>
<span class="nc bnc" id="L1054" title="All 2 branches missed.">                switch (c) {</span>
                    case 8: //backspace
<span class="nc" id="L1056">                        ProgressArea.getStyledDocument().remove(ProgressArea.getStyledDocument().getLength() - 1, ProgressArea.getStyledDocument().getLength());</span>
<span class="nc" id="L1057">                        break;</span>
                    default:
<span class="nc" id="L1059">                        ProgressArea.getStyledDocument().insertString(ProgressArea.getStyledDocument().getLength(), data, null);</span>
                }
            }

<span class="nc" id="L1063">        } catch (BadLocationException ex) {</span>
<span class="nc" id="L1064">            Logger.getLogger(CASUALGUIMain.class.getName()).log(Level.SEVERE, null, ex);</span>
<span class="nc" id="L1065">        }</span>
<span class="nc" id="L1066">        ProgressArea.setCaretPosition(ProgressArea.getDocument().getLength());</span>
<span class="nc" id="L1067">    }</span>

    @Override
    public void setUserMainMessage(String text) {
<span class="nc" id="L1071">    }</span>
    
    @Override
    public String toString(){
<span class="nc" id="L1075">        StringBuilder sb = new StringBuilder();</span>
<span class="nc" id="L1076">        sb.append(&quot;Ready:&quot;).append(this.isReady).append(&quot;\n is dummy:&quot;).append(this.isDummyGUI()).append(&quot;\nStatus:&quot;).append(this.StatusLabel.getText()).append(&quot;\n&quot;).append(this.caspac);</span>
<span class="nc" id="L1077">        return sb.toString();</span>
    }

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.2.201409121644</span></div></body></html>